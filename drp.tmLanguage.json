{
  "$schema": "https://raw.githubusercontent.com/martinring/tmlanguage/master/tmlanguage.json",
  "name": "Dralee File Replace Rule",
  "scopeName": "source.drp",
  "patterns": [
    {
      "include": "#comments"
    },
    {
      "include": "#service-name"
    },
    {
      "include": "#file-config-field"
    },
    {
      "include": "#global-context-config"
    },
    {
      "include": "#replace-item"
    }
  ],
  "repository": {
    "comments": {
      "patterns": [
        {
          "name": "comment.line.number-sign.configenum",
          "match": "^\\s*#.*$"
        }
      ]
    },
    "service-name": {
      "patterns": [
        {
          "name": "meta.service-name.configenum",
          "match": "^\\[([^\\]]+)\\]",
          "captures": {
            "0": {
              "name": "entity.name.section.configenum"
            },
            "1": {
              "name": "entity.name.type.service.configenum"
            }
          }
        }
      ]
    },
    "replace-item": {
      "patterns": [
        {
          "name": "meta.replace-item.configenum",
          "match": "(.*?)(<==>)(.*?)",
          "captures": {
            "0": {
              "name": "string.unquoted.replace-item.configenum"
            },
            "1": {
              "name": "entity.operator.assignment.replace-item.configenum"
            },
            "2": {
              "name": "string.unquoted.replace-item.configenum"
            }
          }
        }
      ]
    },
    "global-context-config": {
      "patterns": [
        {
          "name": "meta.global-context.configenum",
          "begin": "^([a-zA-Z_][a-zA-Z0-9_-]*)\\s*(=)\\s*(?:[^=])",
          "end": "$",
          "beginCaptures": {
            "1": {
              "name": "entity.name.section.configenum"
            },
            "2": {
              "name": "keyword.operator.assignment.configenum"
            }
          },
          "patterns": [
            {
              "include": "#global-path-variable"
            },
            {
              "include": "#global-options"
            }
          ]
        }
      ]
    },
    "global-path-variable": {
      "patterns": [
        {
          "name": "variable.other.path-name",
          "match": "([^\\<\\>:\"\\|\\?\\*])"
        }
      ]
    },
    "global-options": {
      "patterns": [
        {
          "name": "constant.other.option-name",
          "match": "([a-zA-Z_][a-zA-Z0-9_]*)",
          "captures": {
            "1": {
              "name": "entity.name.type.option-name"
            }
          }
        },
        {
          "name": "punctuation.separator.option-item",
          "match": "[,]"
        }
      ]
    },
    "file-config-field": {
      "patterns": [
        {
          "name": "meta.global-context.configenum",
          "match": "^([a-zA-Z_][a-zA-Z0-9_-]*)\\s*(==)\\s*([^\\<\\>:\"\\|\\?\\*=])(=>\\$)",
          "captures": {
            "1": {
              "name": "entity.name.section.configenum"
            },
            "2": {
              "name": "keyword.operator.section.configenum"
            },
            "3": {
              "name": "variable.name.section.configenum"
            },
            "4": {
              "name": "variable.operator.section.configenum"
            }
          },
          "patterns": [
          ]
        }
      ]
    }
  }
}